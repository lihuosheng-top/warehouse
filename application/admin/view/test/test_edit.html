{include file="template/_meta" /}
<title></title>
</head>

{block name="css"}
<link rel="stylesheet" type="text/css" href="__STATIC__/admin/common/css/aaa.css" />
<style type="text/css">
	body {
		background: #fff;
	}
	
	#hot {
		display: flex;
		align-items: center;
		flex-wrap: wrap;
	}
	
	.list {
		margin-right: 10px;
		margin-bottom: 6px;
	}
	
	.title {
		height: 50px;
		background: #F2F2F2;
		font-size: 20px;
		line-height: 50px;
		padding-left: 20px;
		font-weight: bold;
	}
	
	.special,
	.general,
	.special .layui-form-item,
	.general .layui-form-item {
		min-width: 100%;
	}
	
	.add-content {
		background: #F2F2F2;
		width: 100%;
	}
	
	.general-kuang {
		border: solid 1px #E4E4E4;
		width: 1000px;
		padding-left: 10px;
	}
	
	.btus {
		background: #fff;
		border: solid 1px #E4E4E4;
		color: #0099FF;
		width: 141px;
		display: inline-block;
		margin: 10px;
	}
	
	#general-content .layui-form-item {
		width: 100%;
	}
	
	.sky-blue {
		color: #0099FF;
	}
	
	.bgwhite {
		background: #fff;
	}
	
	.noshow {
		display: none;
	}
	
	.special .layui-form-item {
		width: 100%;
	}
	
	.general .layui-form-item {
		width: 100%;
	}
	
	.special .layui-form-item label {
		width: 10%;
	}
	
	.general .layui-form-item label {
		width: 10%;
	}
	
	.operation-btus {
		width: 60px;
		height: 40px;
		border-radius: 3px;
		color: #fff;
	}
	
	.btu-delet {
		background: #FF0000;
	}
	
	.btu-cancel {}
	
	.btu-add {
		background: #0099FF;
	}
	
	.num-content {
		overflow: hidden;
	}
	
	#general_content>div {
		margin-top: 6px;
	}
		/* 弹窗 */
        .tanchuang {
            width: 100%;
            min-height: 1000px;
            background: RGBA(0, 0, 0, 0.3);
            position: fixed;
            z-index: 9999;
        }

	    /* 数据库展现图片样式 */
    
    .img {
        position: relative;
        display: inline-block;
        width: 100px;
    }
     .imgcontent{
    	margin: 10px;
    }
   
    
    .img>i {
        display: inline-block;
        width: 20px;
        position: absolute;
        right: 0;
        top: 0;
    }
</style>

{/block}

<body>
	{block name="content"}
	 <div class="tanchuang noshow">
	 	<div style="width: 395px;height: 527px;margin: 10% auto;">
	 		 <img src="" class="tanimg"/>
	 	</div>
    
    </div>

	<form class="layui-form layui-form-lists" action="{:url('admin/Category/save')}" method="post" enctype="multipart/form-data">
		<div class="form-title">基础信息 </div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>商品名称</label>
			<div class="form-input">
				<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					商品名称必须填写，最多100个字
				</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">出品商</label>
			<div class="form-input">
				<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					选填项
				</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">品牌</label>
			<div class="form-input">
				<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					选填项
				</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">商品编号</label>
			<div class="form-input">
				<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					*可自行设定规则按照2位大写字母+4位数字设定（例如：NB0001)
				</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">商品卖点</label>
			<div class="form-input">
				<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					*在商品列表页、详情页标题下面展示卖点信息，建议60字以内 <span class="tan" style="color: #0E90D2;"data-id = "__STATIC__/admin/common/img/u27672.png">查看实例</span>
				</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">卖点标签</label>
			<div class="form-input" style="display: flex; align-items: center;">
				<div id="hot">
					<div class="list">
						<input type="checkbox" name="marker" lay-skin="primary" title="hot" checked="">
					</div>
					<div class="list">
						<input type="checkbox" name="marker" lay-skin="primary" title="aaa">
					</div>
					<div class="list">
						<input type="checkbox" name="marker" lay-skin="primary" title="特色活动">
						<span style="color: #0EA9E3;font-size: 12px;" class="change_text">修改</span>
					</div>
				</div>

			</div>
			<div class="add_biao">
				+添加文字标签
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">分享描述</label>
			<div class="form-input">
				<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					微信分享给好友时会显示，建议36个字以内<span class="tan" style="color: #0E90D2;" data-id = "__STATIC__/admin/common/img/u27291.png">查看实例</span>
				</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">归属分类</label>
			<div class="form-input">
				<input type="radio" name="status" value="1" title="启用" checked="">
				<input type="radio" name="status" value="0" title="禁用">
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">商品排序</label>
			<div class="form-input">
				<input type="number" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">
					*填写正整数，从大到小排序
				</div>
			</div>
		</div>
		<div class="form-title">价格库存 </div>
		<div class="form-item">
			<label class="form-label">商品规格</label>
			<div class="form-input">
				<input type="radio" name="dfg" value="1" title="统一规格" checked="" lay-filter="guige">
				<input type="radio" name="dfg" value="0" title="特殊规格" lay-filter="guige">
			</div>
		</div>
		<div class="nomal ">
			<div class="form-item">
				<label class="form-label"><span class="red"></span>商品售价</label>
				<div class="form-input line">
					<input type="number" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				</div>
			</div>
			<div class="form-item">
				<label class="form-label">商品划线价</label>
				<div class="form-input line">
					<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
					<span href="" class="tan" data-id = "__STATIC__/admin/common/img/u27291.png"> 查看示例</span>
				</div>
			</div>
			<div class="form-item">
				<label class="form-label"><span class="red"></span>商品成本价</label>
				<div class="form-input line">
					<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
					<div class="tips">
						*成本价不显示到客户端，适用于利润分析等
					</div>
				</div>

			</div>
			<div class="form-item">
				<label class="form-label"><span class="red">*</span>库存</label>
				<div class="form-input line">
					<input type="number" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				</div>
			</div>
			<div class="form-item">
				<label class="form-label">商品折扣</label>
				<div class="form-input line">
					<input type="checkbox" name="marker" lay-skin="primary" title="参加会员折扣">
					<a href="">管理会员卡</a>
				</div>
			</div>
		</div>
		<div class="form-item general noshow">
			<div class="layui-input-block general-kuang">
				<div id="general_content"></div>
				<div class="add-content content" id="add_general_buts">
					<button type="button" class="btus general_buts">添加规格项目</button>
				</div>
			</div>
		</div>
	<div class="form-item">
			<label class="form-label"><span class="red">*</span>第一级菜单图</label>
			<div class="img-edit">
				 <div class="imgcontent" >
                    <span class="img">
						<img src="__STATIC__/admin/common/img/a11.png" width="100%">
						<i class="remove-img" name="icon_image" value="" data-id="" data-value="2"><img src="__STATIC__/admin/common/img/a7.png"></i>
					</span>
                </div>
			<div class="form-input">
				<div class="img-box full">
					<section class=" img-section">
						<div class="z_photo upimg-div clear">
							<section class="z_file fl">
								<img src="__STATIC__/admin/common/upfile/img/a11.png" class="add-img">
								<input type="file" name="icon_image" id="file" class="file" value="" accept="image/jpg,image/jpeg,image/png,image/bmp" multiple data-id="1" />
							</section>
						</div>
					</section>
				</div>
				<aside class="mask works-mask">
					<div class="mask-content">
						<p class="del-p ">您确定要删除作品图片吗？</p>
						<p class="check-p"><span class="del-com wsdel-ok">确定</span><span class="wsdel-no">取消</span></p>
					</div>
				</aside>

			</div>
            </div>
		</div>
		<div class="form-item">
			<label class="form-label">主图视频链接</label>
			<div class="form-input">
				<input type="number" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input">
				<div class="tips">*如何获取视频地址？免费上传视频到七牛云存储</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>商品详情</label>
			<div class="form-input">
				<script id="editor" type="text/plain" name="commodity" style="width:800px;height:500px;"></script>
			</div>
		</div>
		<div class="form-title">价格库存 </div>
		<div class="form-item">
			<label class="form-label">配送方式</label>
			<div class="form-input line">
				<input type="checkbox" name="marker" lay-skin="primary" title="商家配送" checked="">
				<input type="checkbox" name="marker" lay-skin="primary" title="到店自提">
			</div>
		</div>
		<div class="form-item">
			<label class="form-label">快递运费</label>
			<div style="display: flex;flex-direction:column">
				<div class="form-input line" style="margin-bottom: 4px;">
					<input type="radio" name="aaa" value="1" title="商家配送" checked="">
					<input type="number" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input"> </input>
					</input>

				</div>
				<div class="form-input line" style="margin-bottom: 4px;">
					<input type="radio" name="aaa" value="1" title="运费模板">
					<input type="number" name="" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input"> </input>
					</input>
					<a href="">新建</a>
				</div>
				<div class="tips">*运费模版支持按地区设置运费，按购买件数计算运费，按重量计算运费等</div>
			</div>

		</div>
		<div class="form-item">
			<label class="form-label">状态</label>
			<div class="form-input">
				<input type="radio" name="a" value="1" title="暂不上架" checked="">
				<input type="radio" name="a" value="0" title="立即上架">
			</div>
		</div>

		<div class="layui-form-item">
			<div class="layui-input-block">
				<button class="layui-btn layui-btn-normal" type="submit">确认提交</button>
				<button type="button" class="layui-btn layui-btn-primary" onClick="javascript :history.back(-1);">返回</button>
			</div>
		</div>
	</form>

	{/block}

	<!--_footer 作为公共模版分离出去-->
	{include file="template/_footer" /}
	<!--/_footer 作为公共模版分离出去-->

	<!--请在下方写此页面业务相关的脚本-->
	{block name="bottom"}
	<script type="text/javascript">
		var dhtml = "";

		dhtml += '<div>' +
			' 			<div class="layui-form-item">                                                                                 ' +
			' 				<label class="layui-form-label">规格名：</label>                                                               ' +
			' 				<div class="layui-input-inline guige_name">                                                                          ' +
			' 					<select class="universal_standard_name" name="goods_standard_name[]">                                                                                 ' +
			' 						<option value="0" selected="">请选择</option>                                                                    ' +
			' 					</select>                                                                                             ' +
			' 				</div>                                                                                                    '
			//      +'                                                                                                                        '
			+
			' 				<div class="layui-input-inline add-name" style="">                                                        ' +
			' 					<button type="button" class="sky-blue bgwhite">+添加规格名</button>                                        '
			//      +'                                                                                                                        '
			+
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline noshow add-names" style="">                                                ' +
			' 					<input type="text" name="" id="" value="" />   ' +

			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline noshow add-names" style="">                                                ' +
			' 				<button type="button" class="operation-btus btu-delet">删除</button>                                                                     ' +
			' 					<button type="button" class="operation-btus btu-cancel">取消</button>                                                                     ' +
			' 					<button type="button" class="operation-btus btu-add guibtu-add">添加</button>                                                                    ' +
			' 				</div>                                                                                                    ' +
			' 			</div>                                                                                                        ' +
			' 			<div class="layui-form-item">                                                                                 ' +
			' 				<label class="layui-form-label">规格值：</label>                                                              ' +
			' 			<div class="num-content">                                                                                 ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value=""  placeholder="" style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				<div class="layui-input-inline list" style="padding-bottom:10px;margin-right: 25px;" >                                                                          ' +
			' 					<input type="text" name="goods_standard_value[]" id="" value="" placeholder=""  style="padding-left:10px;"/>                                                          ' +
			' 				</div>                                                                                                    ' +
			' 				</div>                                                                                                    ' +
			' 			</div>                                                                                                        ' +
			'          </div>                                                                                                        ';
	</script>

	<script type="text/javascript">
		var ue = UE.getEditor('editor');
		layui.config({
			base: "js/"
		}).use(['form', 'layer', 'jquery', 'laypage', 'upload'], function() {
			var form = layui.form(),
				$ = layui.jquery;
			form.render();
			$(".add_biao").click(function() {
				var dhtml = "";
				dhtml =
					'<div class="list" ><input type="checkbox" name="" lay-skin="primary" title="特色活动"><span style="color: #0EA9E3; font-size: 12px;"  class="change_text">修改</span></div>'
				$("#hot").append(dhtml);
				form.render();
			});

			$("#hot").on('click', ".change_text", function() {
				var texts = $(this).siblings('input');
				layer.prompt({
						title: '请输入修改的文字',
						formType: 2
					},
					function(text, index) {
						texts.attr("title", text);
						layer.close(index);
						form.render();
					});

			})
			//TODO点击取消按钮
			$("#general_content").on('click', ".btu-cancel", function() {
				$(this).parent(".add-names").addClass("noshow");
				$(this).parent().siblings(".add-names").addClass("noshow");
				$(this).parent().siblings(".add-name").removeClass("noshow");
			});

			// TODO商品规格变化
			form.on('radio(guige)', function(data) {
				var checkval = data.value;
				if(checkval == 1) {
					$(".general").addClass("noshow");
					$(".nomal").removeClass("noshow");
					$("#general_content").children("div").remove();
					$(".nomal").children(".form-item").children(".form-input").children("input").attr("disabled", false)

				} else {
					$(".nomal").children(".form-item").children(".form-input").children("input").attr("disabled", true)
					$(".nomal").addClass("noshow");
					$(".general ").removeClass("noshow");
				}

			});
			// 图片删除
        $(".remove-img").click(function() {
            var remove = $(this).parent();
            var id = $(this).data("id");
            var value = $(this).data("value");
            console.log(value)
            console.log(id);
                $.ajax({
                    type: "POST",
                    url: "{:url('admin/Category/images')}",
                    data: {
                        "id": id
                    },
                    dataType: "json",
                    success: function(data) {
                        remove.remove();
                    },
                    error: function(data) {
                        console.log("错误");
                    }
                });
         

        });
			//TODO点击通用添加规格项目添加页面
			$(".general_buts").click(function() {
				$("#general_content").append(dhtml);
				//				$.ajax({
				//					type: "POST",
				//					url: "{:url('admin/Goods/standard_name')}",
				//					data: {},
				//					success: function(data) {
				//						console.log(data);
				//						var data = eval('(' + data + ')');
				//						for(var i = 0; i < data.data.length; i++) {
				//							var dhtml = "";
				//							dhtml = '<option value="' + data.data[i].standard_name + '">' + data.data[i].standard_name + '</option>'
				//							$(".universal_standard_name").append(dhtml);
				//						}
				//
				//						form.render('select');
				//					},
				//					error: function(data) {
				//						console.log(data)
				//					}
				//				});
				form.render('select');

			});
			//	TODO点击添加添加规格名
			$("#general_content").on('click', ".add-name", function() {
				$(this).addClass("noshow");
				$(this).siblings(".add-names").removeClass("noshow");
			});
			$(".tan").click(function(){
				src=$(this).data("id");
				$(".tanchuang").removeClass("noshow");
				$(".tanimg").attr("src", src);
			});
				$(".tanchuang").click(function(){
				$(".tanchuang").addClass("noshow");
			});

		});
	</script>

	{/block}

</body>

</html>